---
title: "MATH 216 Homework 2"
author: "Emily Goins"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    smooth_scroll: false
---

```{r, echo=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(readr) 
```


```{r, echo=FALSE, message=FALSE, cache=TRUE}
# Do not edit this code block. By setting cache=TRUE, we are saving the output 
# of this block to the cache. That way it only needs to run once.  This is
# especially useful for portions of code that take a long time to run.
profiles <- read_csv(file="profiles.csv")
```



## Admistrative:

Please indicate

* Who you collaborated with:
* Roughly how much time you spent on this HW so far:
* The URL of the RPubs published URL [here](https://www.nhl.com/).
* What gave you the most trouble:
* Any comments you have:



## Question 1:

Perform an Exploratory Data Analysis (EDA) on the `profiles` data set,
specifically on the relationship between gender and

* `income`
* `job`
* `smoking`

all keeping in mind in HW-3, you will be fitting a logistic regression to
predict a user's gender based on these variables.

Notes:
  - INCOME: In the first graph, I have excluded most of the outliers so that you can see that females make, on average, less than men. In the second graph, we can see that men also have a wider distribution of income than females. Also, there are more men in each income bracket, and while some of this may be due to the greater number of males on OkCupid, there are not twice the number of males on the site than females.
  - JOB EXPLORATION: This graph shows the proportionality of males to females that are in each type of job. Women have the highest proportion of jobs, in medicine/health, clerical/administrative, and education/academia. Men are found mostly in jobs such as science/tech/engieneeering, construction/craftsmanship, and computer/hardware/software. The disparity here aligns with commonly-held beliefs regarding gender roles. Interestingly, although it is almost 50/50 that are unemployed, there is a slightly higher proportion of men who are unemployed. 
  - SMOKES: I chose to look at smoking because smoking is stigmatized. In addition to showing that a higher proportion of men than women smoke in the first graph, I also looked at the proportion of males and females that did not answer. Men were more likely to not provide an answer.In looking at the frequency of smokers for each gender in the last graph, you can see that the fewest people said "trying to quit". That may be due to some sort of weakness that it displays if you cannot control yourself and stop yourself from smoking if you want to.  
  
```{r, echo=TRUE, message=TRUE, warning=TRUE, fig.width=8, fig.height=4.5}
#INCOME EXPLORATION

#sex vs. income
gIncome <- profiles %>%
  select(sex, income) %>% 
  filter(!is.na(sex)) %>%
  filter(!is.na(income))

#bar graph of mean income for male/female (excluding those who didn't answer (-1))
inc1 <- gIncome %>%
  filter(income != -1) %>%
  group_by(sex)
ggplot(data = inc1, aes(x = sex,
                        y = income)) + geom_boxplot() +
  coord_cartesian(ylim=c(0, 250000)) + #excludes a few outliers but helps to see trend
  xlab("Gender") +
  ylab("Income") +
  ggtitle("Income For Each Gender")

#bar graph showing prop of males/females in each category (excluding those who didn't answer (-1))
inc2 <- gIncome %>%
  group_by(sex, income) %>%
  filter(income != -1) %>%
  tally() %>%
  rename("freq" = n) 
ggplot(data = inc2, aes(x = income, y = freq, fill = sex)) + 
  geom_bar(stat = "identity", position="dodge") + coord_cartesian(ylim=c(0, 1000))
  xlab("Income") +
  ylab("Frequency") +
  ggtitle("Frequency of Income Bracket for Each Gender")

#JOB EXPLORATION
gJob <- profiles %>%
  select(sex, job) %>%
  filter(!is.na(job))
ggplot(data = gJob, aes(x = job, fill = sex)) + geom_bar(position = "fill") + coord_flip() +
  xlab("Proportion of Males/Females") +
  ylab("Job") +
  ggtitle("Proportion of Males/Females in Various Job Categories")

#SMOKES EXPLORATION
gSmokes <- profiles %>%
  select(smokes, sex) %>%
  filter(!is.na(smokes)) 
ggplot(data = gSmokes, aes(x = smokes, fill = sex)) + geom_bar(position = "fill") + coord_flip() + 
  xlab("Proprotion of Males/Females") +
  ylab("Smoking Status") +
  ggtitle("Proportion of Males/Females Who Smoke")

gNASmokes <- profiles %>%
  select(smokes, sex) %>%
  mutate(noanswer = ifelse(is.na(smokes), TRUE, FALSE)) %>% 
  group_by(sex) %>%
  summarise(prop=mean(noanswer))
ggplot(data = gNASmokes, aes(x = sex, y = prop)) + geom_bar(stat = "identity") +
  xlab("Proprotion of Males/Females") +
  ylab("Frequency") +
  ggtitle("Proportion of Males/Females Who Did Not Respond")

gSmokeCount <- profiles %>%
  select(smokes, sex) %>%
  filter(!is.na(smokes)) %>%
  group_by(sex, smokes) %>%
  tally()
ggplot(data = gSmokeCount, aes(x = smokes, y = n)) + geom_bar(stat = "identity") +  
  facet_wrap(~sex) +
  xlab("Smoking Status") +
  ylab("Frequency") +
  ggtitle("Proportion of Males/Females Who Smoke")
  

```



## Question 2:

In the file `HW-2_Shiny_App.Rmd`, build the Shiny App discussed in Lec09 on
Monday 10/3: Using the `movies` data set in the `ggplot2movies` data set, make a
Shiny app that

* Plots budget on the x-axis and rating on the y-axis
* Instead of having a radio button to select the genre of movie (`Action`,
`Animation`, `Comedy`, etc), have a radio button that allows you to toggle
between comedies and non-comedies. This app should be simpler.


